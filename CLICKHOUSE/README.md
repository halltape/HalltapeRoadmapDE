## Куратор раздела

<img align="left" width="200" src="../png/shust.jpg" />

**Шустиков Владимир**, оставивший военную жизнь позади и ушедший в данные с головой. Работаю с данными более 3х лет и останавливаться не собираюсь! Веду:

   [Telegram канал](https://t.me/Shust_DE)
   
   [Youtube канал](https://www.youtube.com/@shust_de)

Если хочешь сменить текущую профессию на Дата Инженера — пиши не стесняйся, я сам проходил этот не легкий путь и тебе помогу https://t.me/ShustDE.

Хочешь улучшить текущий раздел, внести недостающее или поправить формулировку? Предлагай PR и тегай [@ShustGF](https://github.com/ShustGF).

## Напутственные слова перед изучением материала

"Хера куда ты уже забрался. Может всё стоит бросить, да и ну его этот RoadMap, эту дата инженерию, ааа...? Нет, а че так! Готов идти до конца ради своего будущего! Красавчик! Уважения тебе! Никого не слушай и продолжай в том же духе и ты обязательно добьёшься своей цели!".

Изучение на практике такого инструмента, как ClickHouse, достаточно интересное занятие. Это OpenSource, с которым мне приходится достаточно часто мучиться, из-за постоянных проблем с нехваткой, каких либо возможностей, находить обходные пути и о них можно почитать у меня на [канале](https://t.me/Shust_DE) под хештогом **#ClickHouse_ну_ёпт_опять**

В общем и целом мне очень нравится,  как написана [документация](https://clickhouse.com/docs/ru) по ClickHouse, поэтому здесь безумно сжатый материал, который ссылается на другие источники информации. В общем и целом могу сказать по своему опыту, ClickHouse стоит изучать на практике и только на ней. Запомнить всё без проб и ошибок просто напросто не получится!

Приятного изучения.

-----------------
<h1 style="text-align: center;">CLICKHOUSE</h1>

**ClickHouse** — это распределённая аналитическая колоночно-ориентированная система на базе SQL с открытым исходным кодом. 

<p align="center">
    <img src="./../png/ch_logo.jpg" alt="clikhouse"/>
</p>

ClickHouse стоит использовать когда:

* Данных очень много;
* Очень много агрегационных операций;
* Нужна большая историчность данных;

## ClickHouse — колоночная ориентированность

Первое что нужно запомнить ClickHouse — это колоночная БД, т.е. данные считываются по необходимым нам колонкам. В свою очередь это позволяет считывать и агрегировать большой объем данных за коротких промежуток времени.

<p align="center">
    <img src="./../png/ch_column_oriented.gif" alt="ch_column_oriented" width="640" height="480"/>
</p>

Физически колоночная ориентированность, представляет каждую колонку ввиде отдельного файла, из-за чего считывать данные через команду "SELECT *" значит считывать каждый файл таблицы. Сами понимаете, это правило плохого тона.

<p align="center">
    <img src="./../png/gp_ao_colum_orientir.png" alt="Колоночная ориентация" width="320" height="350"/>
</p>

Такое решение позволяет:

* Хорошо сжимать данных;
* Быстро добавлять большие объемы данных, но не изменять или удалять их;
* Быстро выполнять запросы над определенными колонками, за исключением JOIN(Clickhouse плохо обрабатывает Join команды).

## Как работает ClickHouse


  
## Движки ClickHouse

Важную роль в Clickhouse играет движок. Существует 2 типа движков:

1) Движки таблиц
2) Движки баз данных.

Очень хорошо расписана информация по движкам на [официльной странице](https://clickhouse.com/docs/ru/engines/table-engines) ClickHouse.

Особое внимание советую уделить движку **MergeTree**, так как именно семейство этих движков умеет поддерживать TTL(Time to live), т.е. при созданнии таблицы можно задать за какой интервал времени хранить данные, а те данные которые выходят за этот промежуток, будут автоматически удаляться.

Так же советую уделить внимание движку **Distributed**, он позволяется ClickHouse горизонтально масштабироваться и хранить данные на разных серверах или как их принято называть шардах. В свою очередь, такой механизм хранения данных позваляет считывать данные параллельно на каждом шарде, т.е. получается, своего рода, MPP-архитектура, более подробно о ней можно почитать в статье о [GreenPlum](https://github.com/halltape/HalltapeRoadmapDE/blob/main/GREENPLUM/README.md)

## Разворачивание ClickHouse через Docker

Локально ClickHouse можно развернуть с помощью Docker Compose [файла](./../CLICKHOUSE/Dop_mat/docker-compose.yaml). 

Так же если нужно быстро что-то попробовать, можно воспользоваться [песочницей с данными](https://sql.clickhouse.com/?query_id=ASSNFTKPUROV9QRCS5FATTT&chart=eyJ0eXBlIjoibGluZSIsImNvbmZpZyI6eyJ4YXhpcyI6InllYXIiLCJ5YXhpcyI6Ijk5dGhfYXZnX3RlbXAiLCJzZXJpZXMiOiJjb3VudHJ5IiwidGl0bGUiOiJUZW1wZXJhdHVyZSBieSBjb3VudHJ5IGFuZCB5ZWFyIn19&)


