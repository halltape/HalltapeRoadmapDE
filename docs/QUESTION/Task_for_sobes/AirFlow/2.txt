Задача 2. Загрузка CSV-файлов по протоколу SMB в PostgreSQL
Цель задачи
Реализовать DAG, который раз в день подключается к удалённому файловому серверу по протоколу SMB, находит CSV-файл с данными о заказах, считывает его и загружает в PostgreSQL.

Источник и приёмник
Источник: Удаленный файловый сервер (SMB)
Путь: \\fileserver\orders\orders_YYYYMMDD.csv (файл за текущую дату)
Аутентификация: доменная (логин/пароль)
Формат файла: CSV, разделитель ;, кодировка utf-8, заголовок есть
Поля: order_id, customer_id, amount, currency, order_date
Приёмник: PostgreSQL
Идентификатор соединения: postgres_warehouse
Таблица: stg_orders
Режим: вставка новых данных, без очистки (дополнение)

Требования:
- DAG запускается ежедневно в 01:00.
- Используйте SMBHook (из apache-airflow-providers-smb) для доступа к файлу.
- Проверить наличие файла. Если файл не найден, DAG должен завершиться с предупреждением (но не с ошибкой).
- Прочитать CSV, преобразовать order_date в формат DATE, amount — в числовой.
- Загрузить данные в PostgreSQL.
- Регистрировать количество прочитанных строк.

Ожидаемый результат:
- DAG с именем smb_csv_to_postgres.
- Проверка наличия файла.
- Чтение и парсинг CSV.
- Загрузка в PostgreSQL через pandas или copy_expert.
- Использование SMBHook и PostgresHook.

Критерии успех:
- Подключение к SMB работает
- Файл корректно считывается
- Данные загружаются в БД
- Обработка отсутствия файла — без сбоя DAG
- Используются стандартные хуки Airflow

Совет: убедитесь, что в Airflow установлен провайдер apache-airflow-providers-smb и настроен smb_conn.